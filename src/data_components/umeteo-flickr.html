<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-ajax/iron-ajax.html">

<dom-module id="umeteo-flickr">
    <template>
     <span> test </span>
    <iron-ajax id="umeteoFlickrAjax"
    url="https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=9d6288115d10152daefeccc6e50be4b9&safe_search=1&per_page=20&format=json&nojsoncallback=?" handle-as = "json" on-response="getData"  last-response="{{data}}" ></iron-ajax>
   </template>
    <script>
        Polymer(
        {
            is: 'umeteo-flickr',
            properties:
            {
                data: Array,
                <!-- apiKey: -->
                <!-- { -->
                <!--     type: String, -->
                <!--     value: '9d6288115d10152daefeccc6e50be4b9' -->
                <!-- }, -->
                perpage:
                {
                    type: Number,
                    value: 10
                },
                page:
                {
                    type: Number,
                    value: 1
                },
                tags: String,
                photos:{
                   type:Array,
                   value:[]
                }

            },
            ready: function() {
               this.triggerAjax();
            },
            getData: function(evt)
            {

              var photos = evt.detail.xhr.response.photos.photo;
              photos.forEach(function(photo)
                {
                    this.photos.push(
                    {
                        src: 'https://farm' + photo.farm + '.staticflickr.com/' + photo.server + '/' + photo.id + '_' + photo.secret + '.jpg',
                        title: photo.title
                    });
                }.bind(this));
                console.log(this.photos);

            },
            triggerAjax:function(){
               this.$.umeteoFlickrAjax.params = {'tags': this.tags};
               this.$.umeteoFlickrAjax.generateRequest();

            }
        });
    </script>
</dom-module>
